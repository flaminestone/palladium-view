<div class="plan-space very-big-column" >
  <div class="plan-block" routerLinkActive="active"  *ngFor="let plan of plans | sortByCreatedAt:'desc'; let index = index"
       (mouseenter)="show_settings_button(index)" (mouseleave)="hide_settings_button(index)">
    <div id="{{index}}" class="setting plan-setting-button" (click)="settings(plansettingsModal, plan, index, settingsform);">
      <i class="fa fa-cog" aria-hidden="true"></i>
    </div>
    <div class="plan-name">
      <span class="lost-result" title="{{plan.all_statistic['attitude'] || 0 | percent:'2.2-3'}}">{{plan.all_statistic['attitude'] || 0 | percent:'1.0-0'}}</span>

      <div class="statistic status-name" *ngIf="this.statuses">
        <ng-container *ngIf="this.statuses">
        <span *ngFor="let status of plan.statistic" class="status-position"
              [ngStyle]="{ 'width': (status['count'] / plan.all_statistic['all'] * 100) + '%', 'background-color': this.statuses[status['status']]['color']}" (value)=status>
        </span>
        </ng-container>
      </div>
      <a id="plan-name-{{index}}" (click)="open_runs(plan.id)"  [routerLink]="['./plan', plan.id]"> {{plan.name}}</a>
    </div>
  </div>
</div>
<modal #plansettingsModal>
  <modal-header>
    <h1>Plan settings</h1>
  </modal-header>
  <modal-content>
    Change plan name
    <form autocomplete="off" #settingsform="ngForm"  (ngSubmit)="edit_plan(settingsform, plansettingsModal, settingsform.valid )">
      <input type="text" class="plan-name" name="plan_name" ngModel required #plan_name="ngModel" autofocus>
      <small [hidden]="plan_name.valid || (plan_name.pristine && !settingsform.submitted)">
        Plan name can't be empty.
      </small>
    </form>
  </modal-content>
  <modal-footer>
    <button class="btn btn-danger plan-delete-button" (click)="delete_plan(plansettingsModal)">Delete</button>
    <button class="btn btn-success" [disabled]="!settingsform.valid" (click)="settingsform.ngSubmit.emit(settingsform)">Save</button>
  </modal-footer>
</modal>
<router-outlet></router-outlet>
