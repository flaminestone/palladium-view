<div class="result-set-space">
  <div class="toolbar">
    <div class="filter">
      <app-filters [statuses] = statuses [statistic] = statistic [all_data]="" (selected_statuses_emmit)="get_filters($event)"></app-filters>
    </div>
    <div class="buttons">
      <div class="toolbar-element" (click)="get_result_sets_and_cases()">
        <i class="fa fa-refresh" aria-hidden="true" [ngClass]="{'fa-spin': this.loading}"></i>
      </div>
      <div class="toolbar-element" (click)="open_modal()" *ngIf="toolbar_opened()">
        <i class="fa fa-pencil" aria-hidden="true"></i>
      </div>

      <div class="danger toolbar-element" (click)="delete_object()" *ngIf="toolbar_opened()">
        <i class="fa fa-trash" aria-hidden="true"></i>
      </div>
    </div>
  </div>

  <div class="item-list">
    <div class="item hoverer bipolar-item" routerLinkActive="active"
         *ngFor="let object of result_sets_and_cases | statusFilter:filter | sortByCreatedAt:'asc'" [ngStyle]="getStyles(object)">
      <div class="result-set-discriber centered-data">
        <div class="centered-data checkbox-item">
          <input type="checkbox" [(ngModel)]="object.selected">
        </div>
        <div class="item-name" *ngIf="object.path === 'result_set'">
          <a *ngIf="object.path === 'result_set'" [routerLink]="['./result_set', object.id]" title={{object.name}}>{{object.name}}</a>
        </div>
        <div class="item-name" *ngIf="object.path === 'case'">
          <span *ngIf="object.path === 'case'" title={{object.name}}>{{object.name}}</span>
        </div>
        <div *ngIf="this.statuses" class="status-name"><b>{{this.statuses[object['status']].name}}</b></div>
      </div>
    </div>
  </div>
</div>

<modal #Modal>
  <modal-header>
    <h1>Change object name</h1>
  </modal-header>
  <modal-content>
    <form autocomplete="off" #form="ngForm"  (ngSubmit)="edit_object(form, Modal, form.valid )">
      <input type="text" class="result-set-name" name="name" ngModel required #name="ngModel" autofocus>
      <small [hidden]="name.valid || (name.pristine && !form.submitted)">
        result_set name can't be empty.
      </small>
    </form>
  </modal-content>
  <modal-footer>
    <button class="btn btn-success" [disabled]="!form.valid" (click)="form.ngSubmit.emit(form)">Save</button>
  </modal-footer>
</modal>
<modal #AddResultModal>
  <modal-header>
    <h1>Add Result</h1>
  </modal-header>
  <modal-content>
    Add result for <b>{{get_selected_count()}}</b> result_sets
    <form autocomplete="off" #addresultform="ngForm">

      <select ngModel name="result_status" #result_status="ngModel">
        <option *ngFor="let item of  not_blocked_status"
                [ngValue]="item">
          {{statuses[item].name}}
        </option>
      </select>
      <small *ngIf="addresultform.controls['result_status']" [hidden]="(addresultform.controls['result_status'].value !== '') && !addresultform.submitted">
        Need to change status
      </small>
      <textarea placeholder="Result description" class="result-description" name="result_description" ngModel required #result_description="ngModel" autofocus></textarea>
    </form>
  </modal-content>
  <modal-footer>
    <button class="btn btn-success" (click)="add_results(addresultform, AddResultModal, addresultform.valid )">Add result</button>
  </modal-footer>
</modal>

<router-outlet></router-outlet>
