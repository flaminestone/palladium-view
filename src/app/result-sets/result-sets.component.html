<div class="result-set-space">
  <div class="toolbar">
    <div class="filter">
      <app-filters [statuses] = statuses [statistic] = statistic [all_data]="" (selected_statuses_emmit)="get_filters($event)"></app-filters>
    </div>
    <div class="buttons">
      <div class="toolbar-element check_button" (click)="unselect_all()" *ngIf="select_all_flag">
        <i class="fa fa-check-square-o" aria-hidden="true"></i>
      </div>

      <div class="toolbar-element check_button" (click)="select_all()" *ngIf="!select_all_flag">
        <i class="fa fa-square-o" aria-hidden="true"></i>
      </div>
      <div class="toolbar-element add_result_button" (click)="open_modal()" [ngClass]="{'disabled': get_selected_count() === 0}">
        <i class="fa fa-plus-circle" aria-hidden="true"></i> {{get_selected_count()}}
      </div>
      <div class="toolbar-element" (click)="get_result_sets_and_cases()">
        <i class="fa fa-refresh" aria-hidden="true" [ngClass]="{'fa-spin': this.loading}"></i>
      </div>

      <div class="toolbar-element" (click)="open_history_page()" *ngIf="toolbar_opened()">
        <i class="fa fa-history" aria-hidden="true"></i>
      </div>

      <div class="toolbar-element" (click)="open_modal()" *ngIf="toolbar_opened()">
        <i class="fa fa-cogs" aria-hidden="true"></i>
      </div>
    </div>
  </div>

  <div class="item-list">
    <div class="item hoverer bipolar-item"
         *ngFor="let object of result_sets_and_cases | statusFilter:filter | sortByCreatedAt:'asc'" [ngClass]="{'active': object.active}" [ngStyle]="getStyles(object)">
      <div class="result-set-discriber centered-data">
        <div class="centered-data checkbox-item">
          <input type="checkbox" [(ngModel)]="object.selected">
        </div>
        <div class="item-name">
          <a (click)="open_results(object)" title={{object.name}}>{{object.name}}</a>
        </div>
        <div *ngIf="this.statuses" class="status-name"><b>{{this.statuses[object['status']].name}}</b></div>
      </div>
    </div>
  </div>
</div>

<modal #Modal>
  <modal-header>
    <h1>Change object name</h1>
  </modal-header>
  <modal-content>

    <div class="settings_content">
      <div class="item-description">
        <div class="item-option">
          <form autocomplete="off" #form="ngForm"  (ngSubmit)="edit_object(form, form.valid )">
            <input type="text" class="result-set-name" name="name" ngModel required #name="ngModel" autofocus>
            <small [hidden]="name.valid || (name.pristine && !form.submitted)">
              result_set name can't be empty.
            </small>
          </form>

        </div>

      </div>
    </div>
    <button class="btn btn-success" [disabled]="!form.valid" (click)="form.ngSubmit.emit(form)">Save</button>
    <button class="btn btn-danger" (click)="delete_object()">Delete</button>
  </modal-content>
</modal>

<modal #AddResultModal>
  <modal-header>
    <h1>Add Result</h1>
  </modal-header>
  <modal-content>
    Add result for <b>{{get_selected_count()}}</b> result_sets
    <form autocomplete="off" #addresultform="ngForm">

      <select ngModel name="result_status" #result_status="ngModel">
        <option *ngFor="let item of  not_blocked_status"
                [ngValue]="item">
          {{statuses[item].name}}
        </option>
      </select>
      <small *ngIf="addresultform.controls['result_status']" [hidden]="(addresultform.controls['result_status'].value !== '') && !addresultform.submitted">
        Need to change status
      </small>
      <textarea placeholder="Result description" class="result-description" name="result_description" ngModel required #result_description="ngModel" autofocus></textarea>
    </form>
  </modal-content>
  <modal-footer>
    <button class="btn btn-success" (click)="add_results(addresultform, AddResultModal, addresultform.valid )">Add result</button>
  </modal-footer>
</modal>

<router-outlet></router-outlet>
