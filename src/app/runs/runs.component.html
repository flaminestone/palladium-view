<div class="run-space very-big-column">
  <app-filters #Filter [all_data]="runs_and_suites" [statuses] = statuses [statistic]="statistic" (selected_statuses_emmit)="get_filters($event)"></app-filters>
  <div class="runs-list">
    <ng-container *ngIf="runs_and_suites && statuses">
      <div class="run-block" routerLinkActive="active" *ngFor="let object of runs_and_suites| statisticFilter:filter ; let index = index" (mouseenter)="show_settings_button(index)" (mouseleave)="hide_settings_button(index)">
        <div id="{{index}}" class="setting run-setting-button" (click)="settings(runsettingsModal, object, index, settingsform);">
          <i class="fa fa-cog" aria-hidden="true"></i>
        </div>
        <div class="run-name">
          <span class="lost-result" title="{{object.statistic.attitude || 0 | percent:'2.2-3'}}">{{force_floor(object.statistic.attitude) || 0 | percent}}</span>
          <div class="run-name-link">

            <div class="statistic status-name">

        <span *ngFor="let status of object.statistic.existed_statuses" class="status-position"
              [ngStyle]="{ 'width': (object.statistic.extended[status] / object.statistic.all * 100) + '%', 'background-color': statuses[status]['color']}">
        </span>
            </div>
            <a id="run-name-{{index}}" class="run-name" (click)="open_result_sets(object.id)" [routerLink]="[object.path, object.id]">{{object.name}}</a>
          </div>
          <div class="status-legend-small-block">
        <span *ngFor="let status of object.statistic.existed_statuses" class="status-legend-small">
          {{ object.statistic.extended[status] }} {{ this.statuses[status]['name'] }},
        </span>
          </div>
        </div>
      </div>
    </ng-container>
  </div>
</div>

<modal #runsettingsModal>
  <modal-header>
    <h1>Run settings</h1>
  </modal-header>
  <modal-content>
    Change run name
    <form autocomplete="off" #settingsform="ngForm"  (ngSubmit)="edit_run(settingsform, runsettingsModal, settingsform.valid )">
      <input type="text" class="run-name" name="run_name" ngModel required #run_name="ngModel" autofocus>
      <small [hidden]="run_name.valid || (run_name.pristine && !settingsform.submitted)">
        Run name can't be empty.
      </small>
    </form>
  </modal-content>
  <modal-footer>
    <button class="btn btn-danger plan-delete-button" (click)="delete_object(runsettingsModal)">Delete</button>
    <button class="btn btn-success" [disabled]="!settingsform.valid" (click)="settingsform.ngSubmit.emit(settingsform)">Save</button>
  </modal-footer>
</modal>

<router-outlet></router-outlet>
